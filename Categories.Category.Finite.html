<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Categories.Category.Finite</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--without-K</a> <a id="25" class="Pragma">--safe</a> <a id="32" class="Symbol">#-}</a>

<a id="37" class="Keyword">module</a> <a id="44" href="Categories.Category.Finite.html" class="Module">Categories.Category.Finite</a> <a id="71" class="Keyword">where</a>

<a id="78" class="Keyword">open</a> <a id="83" class="Keyword">import</a> <a id="90" href="Level.html" class="Module">Level</a>
<a id="96" class="Keyword">open</a> <a id="101" class="Keyword">import</a> <a id="108" href="Data.Product.html" class="Module">Data.Product</a> <a id="121" class="Keyword">using</a> <a id="127" class="Symbol">(</a><a id="128" href="Agda.Builtin.Sigma.html#166" class="Record">Σ</a><a id="129" class="Symbol">;</a> <a id="131" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a><a id="134" class="Symbol">;</a> <a id="136" href="Data.Product.html#1483" class="Function">∃₂</a><a id="138" class="Symbol">)</a>
<a id="140" class="Keyword">open</a> <a id="145" class="Keyword">import</a> <a id="152" href="Function.Equality.html" class="Module">Function.Equality</a> <a id="170" class="Keyword">using</a> <a id="176" class="Symbol">(</a><a id="177" href="Function.Equality.html#661" class="Record">Π</a><a id="178" class="Symbol">;</a> <a id="180" href="Function.Equality.html#990" class="Function Operator">_⟶_</a><a id="183" class="Symbol">)</a>
<a id="185" class="Keyword">open</a> <a id="190" class="Keyword">import</a> <a id="197" href="Function.Inverse.html" class="Module">Function.Inverse</a>
<a id="214" class="Keyword">open</a> <a id="219" class="Keyword">import</a> <a id="226" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="235" class="Symbol">as</a> <a id="238" class="Module">ℕ</a> <a id="240" class="Keyword">hiding</a> <a id="247" class="Symbol">(</a><a id="248" href="Data.Nat.Base.html#1640" class="Function Operator">_⊔_</a><a id="251" class="Symbol">)</a>
<a id="253" class="Keyword">import</a> <a id="260" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="269" class="Symbol">as</a> <a id="272" class="Module">Fin</a>
<a id="276" class="Keyword">open</a> <a id="281" class="Keyword">import</a> <a id="288" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="297" class="Symbol">as</a> <a id="300" class="Module">Vec</a>
<a id="304" class="Keyword">open</a> <a id="309" class="Keyword">import</a> <a id="316" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="332" class="Keyword">using</a> <a id="338" class="Symbol">(</a><a id="339" href="Relation.Binary.Bundles.html#995" class="Record">Setoid</a><a id="345" class="Symbol">)</a>
<a id="347" class="Keyword">import</a> <a id="354" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="392" class="Symbol">as</a> <a id="395" class="Module">≡</a>

<a id="398" class="Keyword">open</a> <a id="403" class="Keyword">import</a> <a id="410" href="Categories.Category.html" class="Module">Categories.Category</a>
<a id="430" class="Keyword">open</a> <a id="435" href="Function.Equality.html#661" class="Module">Π</a>

<a id="FiniteSetoid"></a><a id="438" href="Categories.Category.Finite.html#438" class="Function">FiniteSetoid</a> <a id="451" class="Symbol">:</a> <a id="453" class="Symbol">∀</a> <a id="455" class="Symbol">{</a><a id="456" href="Categories.Category.Finite.html#456" class="Bound">c</a> <a id="458" href="Categories.Category.Finite.html#458" class="Bound">ℓ</a><a id="459" class="Symbol">}</a> <a id="461" href="Categories.Category.Finite.html#461" class="Bound">n</a> <a id="463" class="Symbol">(</a><a id="464" href="Categories.Category.Finite.html#464" class="Bound">S</a> <a id="466" class="Symbol">:</a> <a id="468" href="Relation.Binary.Bundles.html#995" class="Record">Setoid</a> <a id="475" href="Categories.Category.Finite.html#456" class="Bound">c</a> <a id="477" href="Categories.Category.Finite.html#458" class="Bound">ℓ</a><a id="478" class="Symbol">)</a> <a id="480" class="Symbol">→</a> <a id="482" class="PrimitiveType">Set</a> <a id="486" class="Symbol">_</a>
<a id="488" href="Categories.Category.Finite.html#438" class="Function">FiniteSetoid</a> <a id="501" href="Categories.Category.Finite.html#501" class="Bound">n</a> <a id="503" href="Categories.Category.Finite.html#503" class="Bound">S</a> <a id="505" class="Symbol">=</a> <a id="507" href="Function.Inverse.html#1162" class="Record">Inverse</a> <a id="515" class="Symbol">(</a><a id="516" href="Relation.Binary.PropositionalEquality.html#2290" class="Function">≡.setoid</a> <a id="525" class="Symbol">(</a><a id="526" href="Data.Fin.Base.html#1061" class="Datatype">Fin.Fin</a> <a id="534" href="Categories.Category.Finite.html#501" class="Bound">n</a><a id="535" class="Symbol">))</a> <a id="538" href="Categories.Category.Finite.html#503" class="Bound">S</a>

<a id="541" class="Keyword">record</a> <a id="Finite"></a><a id="548" href="Categories.Category.Finite.html#548" class="Record">Finite</a> <a id="555" class="Symbol">{</a><a id="556" href="Categories.Category.Finite.html#556" class="Bound">o</a> <a id="558" href="Categories.Category.Finite.html#558" class="Bound">ℓ</a> <a id="560" href="Categories.Category.Finite.html#560" class="Bound">e</a><a id="561" class="Symbol">}</a> <a id="563" class="Symbol">(</a><a id="564" href="Categories.Category.Finite.html#564" class="Bound">C</a> <a id="566" class="Symbol">:</a> <a id="568" href="Categories.Category.Core.html#398" class="Record">Category</a> <a id="577" href="Categories.Category.Finite.html#556" class="Bound">o</a> <a id="579" href="Categories.Category.Finite.html#558" class="Bound">ℓ</a> <a id="581" href="Categories.Category.Finite.html#560" class="Bound">e</a><a id="582" class="Symbol">)</a> <a id="584" class="Symbol">:</a> <a id="586" class="PrimitiveType">Set</a> <a id="590" class="Symbol">(</a><a id="591" href="Categories.Category.Finite.html#556" class="Bound">o</a> <a id="593" href="Agda.Primitive.html#636" class="Primitive Operator">⊔</a> <a id="595" href="Categories.Category.Finite.html#558" class="Bound">ℓ</a> <a id="597" href="Agda.Primitive.html#636" class="Primitive Operator">⊔</a> <a id="599" href="Categories.Category.Finite.html#560" class="Bound">e</a><a id="600" class="Symbol">)</a> <a id="602" class="Keyword">where</a>
  <a id="610" class="Keyword">open</a> <a id="615" href="Categories.Category.Core.html#398" class="Module">Category</a> <a id="624" href="Categories.Category.Finite.html#564" class="Bound">C</a>
  
  <a id="631" class="Keyword">field</a>
    <a id="Finite.∣Obj∣"></a><a id="641" href="Categories.Category.Finite.html#641" class="Field">∣Obj∣</a> <a id="647" class="Symbol">:</a> <a id="649" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="Finite.∣_⇒_∣"></a><a id="655" href="Categories.Category.Finite.html#655" class="Field Operator">∣_⇒_∣</a> <a id="661" class="Symbol">:</a> <a id="663" href="Categories.Category.Core.html#515" class="Function">Obj</a> <a id="667" class="Symbol">→</a> <a id="669" href="Categories.Category.Core.html#515" class="Function">Obj</a> <a id="673" class="Symbol">→</a> <a id="675" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

    <a id="Finite.Obj-finite"></a><a id="682" href="Categories.Category.Finite.html#682" class="Field">Obj-finite</a> <a id="693" class="Symbol">:</a> <a id="695" href="Categories.Category.Finite.html#438" class="Function">FiniteSetoid</a> <a id="708" href="Categories.Category.Finite.html#641" class="Field">∣Obj∣</a> <a id="714" class="Symbol">(</a><a id="715" href="Relation.Binary.PropositionalEquality.html#2290" class="Function">≡.setoid</a> <a id="724" href="Categories.Category.Core.html#515" class="Function">Obj</a><a id="727" class="Symbol">)</a>
    <a id="Finite.⇒-finite"></a><a id="733" href="Categories.Category.Finite.html#733" class="Field">⇒-finite</a>   <a id="744" class="Symbol">:</a> <a id="746" class="Symbol">∀</a> <a id="748" href="Categories.Category.Finite.html#748" class="Bound">A</a> <a id="750" href="Categories.Category.Finite.html#750" class="Bound">B</a> <a id="752" class="Symbol">→</a> <a id="754" href="Categories.Category.Finite.html#438" class="Function">FiniteSetoid</a> <a id="767" href="Categories.Category.Finite.html#655" class="Field Operator">∣</a> <a id="769" href="Categories.Category.Finite.html#748" class="Bound">A</a> <a id="771" href="Categories.Category.Finite.html#655" class="Field Operator">⇒</a> <a id="773" href="Categories.Category.Finite.html#750" class="Bound">B</a> <a id="775" href="Categories.Category.Finite.html#655" class="Field Operator">∣</a> <a id="777" class="Symbol">(</a><a id="778" href="Categories.Category.Core.html#1873" class="Function">hom-setoid</a> <a id="789" class="Symbol">{</a><a id="790" href="Categories.Category.Finite.html#748" class="Bound">A</a><a id="791" class="Symbol">}</a> <a id="793" class="Symbol">{</a><a id="794" href="Categories.Category.Finite.html#750" class="Bound">B</a><a id="795" class="Symbol">})</a>

  <a id="801" class="Keyword">module</a> <a id="Obj-finite"></a><a id="808" href="Categories.Category.Finite.html#808" class="Module">Obj-finite</a>   <a id="821" class="Symbol">=</a> <a id="823" href="Function.Inverse.html#1162" class="Module">Inverse</a> <a id="831" href="Categories.Category.Finite.html#682" class="Field">Obj-finite</a>
  <a id="844" class="Keyword">module</a> <a id="⇒-finite"></a><a id="851" href="Categories.Category.Finite.html#851" class="Module">⇒-finite</a> <a id="860" href="Categories.Category.Finite.html#860" class="Bound">A</a> <a id="862" href="Categories.Category.Finite.html#862" class="Bound">B</a> <a id="864" class="Symbol">=</a> <a id="866" href="Function.Inverse.html#1162" class="Module">Inverse</a> <a id="874" class="Symbol">(</a><a id="875" href="Categories.Category.Finite.html#733" class="Field">⇒-finite</a> <a id="884" href="Categories.Category.Finite.html#860" class="Bound">A</a> <a id="886" href="Categories.Category.Finite.html#862" class="Bound">B</a><a id="887" class="Symbol">)</a>

  <a id="892" class="Keyword">private</a>
    <a id="Finite.Fins"></a><a id="904" href="Categories.Category.Finite.html#904" class="Function">Fins</a> <a id="909" class="Symbol">:</a> <a id="911" class="Symbol">∀</a> <a id="913" href="Categories.Category.Finite.html#913" class="Bound">n</a> <a id="915" class="Symbol">→</a> <a id="917" href="Data.Vec.Base.html#935" class="Datatype">Vec</a> <a id="921" class="Symbol">(</a><a id="922" href="Data.Fin.Base.html#1061" class="Datatype">Fin.Fin</a> <a id="930" href="Categories.Category.Finite.html#913" class="Bound">n</a><a id="931" class="Symbol">)</a> <a id="933" href="Categories.Category.Finite.html#913" class="Bound">n</a>
    <a id="939" href="Categories.Category.Finite.html#904" class="Function">Fins</a> <a id="944" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">ℕ.zero</a>    <a id="954" class="Symbol">=</a> <a id="956" href="Data.Vec.Base.html#971" class="InductiveConstructor">[]</a>
    <a id="963" href="Categories.Category.Finite.html#904" class="Function">Fins</a> <a id="968" class="Symbol">(</a><a id="969" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">ℕ.suc</a> <a id="975" href="Categories.Category.Finite.html#975" class="Bound">n</a><a id="976" class="Symbol">)</a> <a id="978" class="Symbol">=</a> <a id="980" href="Data.Fin.Base.html#1802" class="Function">Fin.fromℕ</a> <a id="990" href="Categories.Category.Finite.html#975" class="Bound">n</a> <a id="992" href="Data.Vec.Base.html#990" class="InductiveConstructor Operator">∷</a> <a id="994" href="Data.Vec.Base.html#2466" class="Function">Vec.map</a> <a id="1002" class="Symbol">(</a><a id="1003" href="Data.Fin.Base.html#2267" class="Function">Fin.raise</a> <a id="1013" class="Number">1</a><a id="1014" class="Symbol">)</a> <a id="1016" class="Symbol">(</a><a id="1017" href="Categories.Category.Finite.html#904" class="Function">Fins</a> <a id="1022" href="Categories.Category.Finite.html#975" class="Bound">n</a><a id="1023" class="Symbol">)</a>

  <a id="1028" class="Comment">-- enumeration of all objects</a>
  <a id="Finite.Objs"></a><a id="1060" href="Categories.Category.Finite.html#1060" class="Function">Objs</a> <a id="1065" class="Symbol">:</a> <a id="1067" href="Data.Vec.Base.html#935" class="Datatype">Vec</a> <a id="1071" href="Categories.Category.Core.html#515" class="Function">Obj</a> <a id="1075" href="Categories.Category.Finite.html#641" class="Field">∣Obj∣</a>
  <a id="1083" href="Categories.Category.Finite.html#1060" class="Function">Objs</a> <a id="1088" class="Symbol">=</a> <a id="1090" href="Data.Vec.Base.html#2466" class="Function">Vec.map</a> <a id="1098" class="Symbol">(</a><a id="1099" href="Function.Inverse.html#1300" class="Function">Obj-finite.to</a> <a id="1113" href="Function.Equality.html#836" class="Field Operator">⟨$⟩_</a><a id="1117" class="Symbol">)</a> <a id="1119" class="Symbol">(</a><a id="1120" href="Categories.Category.Finite.html#904" class="Function">Fins</a> <a id="1125" href="Categories.Category.Finite.html#641" class="Field">∣Obj∣</a><a id="1130" class="Symbol">)</a>

  <a id="1135" class="Keyword">private</a>
    <a id="Finite.ObjPairs"></a><a id="1147" href="Categories.Category.Finite.html#1147" class="Function">ObjPairs</a> <a id="1156" class="Symbol">:</a> <a id="1158" class="Symbol">∀</a> <a id="1160" class="Symbol">{</a><a id="1161" href="Categories.Category.Finite.html#1161" class="Bound">a</a><a id="1162" class="Symbol">}</a> <a id="1164" class="Symbol">{</a><a id="1165" href="Categories.Category.Finite.html#1165" class="Bound">A</a> <a id="1167" class="Symbol">:</a> <a id="1169" class="PrimitiveType">Set</a> <a id="1173" href="Categories.Category.Finite.html#1161" class="Bound">a</a><a id="1174" class="Symbol">}</a> <a id="1176" class="Symbol">→</a> <a id="1178" class="Symbol">(</a><a id="1179" href="Categories.Category.Core.html#515" class="Function">Obj</a> <a id="1183" class="Symbol">→</a> <a id="1185" href="Categories.Category.Core.html#515" class="Function">Obj</a> <a id="1189" class="Symbol">→</a> <a id="1191" href="Categories.Category.Finite.html#1165" class="Bound">A</a><a id="1192" class="Symbol">)</a> <a id="1194" class="Symbol">→</a> <a id="1196" href="Data.Vec.Base.html#935" class="Datatype">Vec</a> <a id="1200" href="Categories.Category.Finite.html#1165" class="Bound">A</a> <a id="1202" class="Symbol">(</a><a id="1203" href="Categories.Category.Finite.html#641" class="Field">∣Obj∣</a> <a id="1209" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">*</a> <a id="1211" href="Categories.Category.Finite.html#641" class="Field">∣Obj∣</a><a id="1216" class="Symbol">)</a>
    <a id="1222" href="Categories.Category.Finite.html#1147" class="Function">ObjPairs</a> <a id="1231" class="Symbol">{_}</a> <a id="1235" class="Symbol">{</a><a id="1236" href="Categories.Category.Finite.html#1236" class="Bound">A</a><a id="1237" class="Symbol">}</a> <a id="1239" href="Categories.Category.Finite.html#1239" class="Bound">f</a> <a id="1241" class="Symbol">=</a> <a id="1243" href="Categories.Category.Finite.html#1060" class="Function">Objs</a> <a id="1248" href="Data.Vec.Base.html#4242" class="Function Operator">&gt;&gt;=</a> <a id="1252" href="Categories.Category.Finite.html#1267" class="Function">ap</a>
      <a id="1261" class="Keyword">where</a> <a id="1267" href="Categories.Category.Finite.html#1267" class="Function">ap</a> <a id="1270" class="Symbol">:</a> <a id="1272" href="Categories.Category.Core.html#515" class="Function">Obj</a> <a id="1276" class="Symbol">→</a> <a id="1278" href="Data.Vec.Base.html#935" class="Datatype">Vec</a> <a id="1282" href="Categories.Category.Finite.html#1236" class="Bound">A</a> <a id="1284" href="Categories.Category.Finite.html#641" class="Field">∣Obj∣</a>
            <a id="1302" href="Categories.Category.Finite.html#1267" class="Function">ap</a> <a id="1305" href="Categories.Category.Finite.html#1305" class="Bound">X</a> <a id="1307" class="Symbol">=</a> <a id="1309" href="Data.Vec.Base.html#2466" class="Function">Vec.map</a> <a id="1317" class="Symbol">(</a><a id="1318" href="Categories.Category.Finite.html#1239" class="Bound">f</a> <a id="1320" href="Categories.Category.Finite.html#1305" class="Bound">X</a><a id="1321" class="Symbol">)</a> <a id="1323" href="Categories.Category.Finite.html#1060" class="Function">Objs</a>

  <a id="1331" class="Comment">-- enumeration of all morphisms of a given pair of objects</a>
  <a id="Finite.⟦_⇒_⟧"></a><a id="1392" href="Categories.Category.Finite.html#1392" class="Function Operator">⟦_⇒_⟧</a> <a id="1398" class="Symbol">:</a> <a id="1400" class="Symbol">∀</a> <a id="1402" href="Categories.Category.Finite.html#1402" class="Bound">A</a> <a id="1404" href="Categories.Category.Finite.html#1404" class="Bound">B</a> <a id="1406" class="Symbol">→</a> <a id="1408" href="Data.Vec.Base.html#935" class="Datatype">Vec</a> <a id="1412" class="Symbol">(</a><a id="1413" href="Categories.Category.Finite.html#1402" class="Bound">A</a> <a id="1415" href="Categories.Category.Core.html#531" class="Function Operator">⇒</a> <a id="1417" href="Categories.Category.Finite.html#1404" class="Bound">B</a><a id="1418" class="Symbol">)</a> <a id="1420" href="Categories.Category.Finite.html#655" class="Field Operator">∣</a> <a id="1422" href="Categories.Category.Finite.html#1402" class="Bound">A</a> <a id="1424" href="Categories.Category.Finite.html#655" class="Field Operator">⇒</a> <a id="1426" href="Categories.Category.Finite.html#1404" class="Bound">B</a> <a id="1428" href="Categories.Category.Finite.html#655" class="Field Operator">∣</a>
  <a id="1432" href="Categories.Category.Finite.html#1392" class="Function Operator">⟦</a> <a id="1434" href="Categories.Category.Finite.html#1434" class="Bound">A</a> <a id="1436" href="Categories.Category.Finite.html#1392" class="Function Operator">⇒</a> <a id="1438" href="Categories.Category.Finite.html#1438" class="Bound">B</a> <a id="1440" href="Categories.Category.Finite.html#1392" class="Function Operator">⟧</a> <a id="1442" class="Symbol">=</a> <a id="1444" href="Data.Vec.Base.html#2466" class="Function">Vec.map</a> <a id="1452" class="Symbol">(</a><a id="1453" href="Function.Inverse.html#1300" class="Function">⇒-finite.to</a> <a id="1465" href="Categories.Category.Finite.html#1434" class="Bound">A</a> <a id="1467" href="Categories.Category.Finite.html#1438" class="Bound">B</a> <a id="1469" href="Function.Equality.html#836" class="Field Operator">⟨$⟩_</a><a id="1473" class="Symbol">)</a> <a id="1475" class="Symbol">(</a><a id="1476" href="Categories.Category.Finite.html#904" class="Function">Fins</a> <a id="1481" href="Categories.Category.Finite.html#655" class="Field Operator">∣</a> <a id="1483" href="Categories.Category.Finite.html#1434" class="Bound">A</a> <a id="1485" href="Categories.Category.Finite.html#655" class="Field Operator">⇒</a> <a id="1487" href="Categories.Category.Finite.html#1438" class="Bound">B</a> <a id="1489" href="Categories.Category.Finite.html#655" class="Field Operator">∣</a><a id="1490" class="Symbol">)</a>

  <a id="1495" class="Comment">-- number of all morphisms</a>
  <a id="Finite.∣-⇒-|"></a><a id="1524" href="Categories.Category.Finite.html#1524" class="Function">∣-⇒-|</a> <a id="1530" class="Symbol">:</a> <a id="1532" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
  <a id="1536" href="Categories.Category.Finite.html#1524" class="Function">∣-⇒-|</a> <a id="1542" class="Symbol">=</a> <a id="1544" href="Data.Vec.Base.html#4641" class="Function">foldr</a> <a id="1550" class="Symbol">(λ</a> <a id="1553" href="Categories.Category.Finite.html#1553" class="Bound">_</a> <a id="1555" class="Symbol">→</a> <a id="1557" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1558" class="Symbol">)</a> <a id="1560" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+_</a> <a id="1564" class="Number">0</a> <a id="1566" class="Symbol">(</a><a id="1567" href="Categories.Category.Finite.html#1147" class="Function">ObjPairs</a> <a id="1576" href="Categories.Category.Finite.html#655" class="Field Operator">∣_⇒_∣</a><a id="1581" class="Symbol">)</a>
</pre></body></html>